# 서브넷팅과 VLSM

### 1. IPv4

- 3계층인 네트워크 계층에서 정의
- 최선형 서비스를 이용해 패킷 전달
- 목적지 도착을 보장하지 않음
- 32비트로 4개의 옥텟Octet으로 구분됨 (0.0.0.0~255.255.255.255)
- 사설 IP 대역과 공인 IP 주소 대역이 있으며, 외부로 통신하기 위해서 반드시 공인 IP 대역의 주소를 사용해야 함
- 주소 대역이 A,B,C,D,E의 형태로 나뉘어져 있으며, 장치에 할당해 사용
    - 사용가능한 주소 대역은 A,B,C
    - D는 멀티캐스트용으로 사용
    - E는 연구용으로 남김
    

### 2. IPv6

- v4의 주소 부족 문제 해결을 위해 등장
- 128비트 16진수를 사용해 주소를 표현해 주소 자동 생성
- 주소 생략이 가능
    - 각 필드에서 선행하는 0은 생략이 가능 - 0207 → 207, 00BC → BC, 0000 → 0
    - 연속된 0은 모두 삭제할 수 있으며, 이 때 2개의 이중 콜론으로 이를 나타내며, 주소당 한 번만 사용할 수 있음 - BCAF:0:0:0:0:5641:F9FF:4102 ⇒ BCAF::5641:F9FF:4102
- IPv4와 IPv6의 차이
    
    
    | 구분 | IPv4 | IPv6 |
    | --- | --- | --- |
    | 주소 길이 | 32비트 | 128비트 |
    | 표시 방법 | 8비트씩 4개 부분으로 나눠 10진수로 표시 | 16비트씩 8개 부분으로 나눠 16진수로 표시 |
    | 주소 개수 | 42억개 | 2의 128승 |
    | 주소 할당 방식 | A,B,C,D 등의 클래스 단위로 비순차적 할당 | 네트워크 규모, 단말기 수에 따라 순차적 할당 |
    | 브로드 캐스트 주소 | 있음 | 없음(로컬 범위 내에서의 모든 노드에 대한 멀티캐스트 주소 사용) |
    | 보안 | IPSec 별도 설치 | IPSec 지원 |

- IPv6 헤더
    - 버전
    - 트래픽 클래스 - 패킷의 클래스나 우선순위 표시
    - 플로우 레이블 - 패킷들의 어떤 특정 흐름에 대한 특성
    - 페이로드 길이
    - next header - 기본 헤더 다음에 어떤 종류의 확장 헤더가 오는지 표시
    - 홉 제한 - 라우터를 지날 때마다 이 값을 1씩 감소시키고 0이 되면 폐기
    

### 3. IPv4 주소의 구조

- 2진수로 표현되며 이를 10진수로 변환해 사용
- 2의 32승 개의 주소를 가짐
- 네트워크 장치는 고유의 IP 주소를 가짐
- 주소가 같은 다른 장비가 존재하면 IP 주소가 충돌하므로 데이터 통신이 이뤄질 수 없음
- 네트워크에 연결된 장치에 할당된 IP주소는 유일한 주소여야 함
- IP주소는 네트워크 부분(고정된 비트)과 host 부분(고정되지 않은 비트)으로 구분되어짐
- Netword ID에 1을 할당하고 Host ID에 0을 할당한 값을 Subnet mask라고 함
- IP주소를 Network 부분과 Host 부분으로 구분해주는 역할을 하는 것이 Subnet Mask 이며 IPv4의 주소 범위 중 A Class는 8비트, B Class는 16비트, C Class는 24비트의 기본 서브넷 값을 가짐
- 서브넷 값은 2진수로 표현했을 때, 1이 연속적으로 나와야 함

### 4. Class 별 분류

1. A Class 주소 (0.0.0.0 ~ 127.255.255.255)
    1. 0과 127로 시작하는 주소는 예약되어 있으므로 사용할 수 없음
    2. 따라서 1.0.0.0 ~ 126.255.255.255가 실 주소 범위
    3. 기본 서브넷 마스크 값은 8비트(255.0.0.0)
    4. **10.0.0.0 ~ 10.255.255.255의 범위는 사설 IP 대역**
    5. Network 숫자 : 16,384
        
        네트워크 당 호스트 숫자 : 65,534개
        
2. B Class 주소 (128.0.0.0 ~ 191.255.255.255)
    1. 기본 서브넷 마스크 값은 16비트(255.255.0.0)
    2. **172.16.0.0 ~ 172.31.255.255의 범위는 사설 IP 대역**
        
        
3. C Class (192.0.0.0 ~ 223.255.255.255)
    1. 기본 서브넷 마스크 값은 24비트(255.255.255.0)
    2. **192.168.0.0 ~ 192.168.255.255의 범위는 사설 IP 대역**
        
        
4. D Class (224.0.0.0 ~ 239.255.255.255)
    1. 멀티캐스트에 의해 사용되는 주소 대역
    2. 일반 장치에 할당되어 사용할 수 없음
    
5. E Class (240.0.0.0 ~ 255.255.255.255)
    1. 연구등의 용도로 예약되어 있는 주소
    2. 일반 장치에 할당되어 사용할 수 없음

1. 네트워크 ID와 브로드캐스트 주소
    1. 호스트 필드를 모두 0로 채우면 network id
    2. 호스트 필드를 모두 1으로 채우면 Broadcast 주소
    3. 네트워크 ID와 브로드캐스트 주소는 IP 주소로 사용할 수 없음
    4. 사용 가능한 IP 주소는 : 203.230.7.1 ~ 203.230.7.254 (총 호스트의 숫자 - 2) = 사용 가능한 IP 주소의 숫자

### 4. 서브넷팅과 VLSM

1. 서브넷팅
    1. IP 주소 자원을 효율적으로 사용하기 위함
    2. 클래스별로 지정된 기본 서브넷 마스크를 사용하지 않고, 네트워크 상황에 따라 적당한 크기의 서브넷 마스크를 사용해 IP 주소를 사용
    3. 호스트 비트로 할당된 비트 일부를 서브넷 비트로 지정
    4. 호스트 필드의 비트를 빌려서 네트워크를 나눔
    5. 네트워크가 서브넷의 조건인 경우, 2의 n승 ≥ 주어진 네트워크 숫자로 계산
        1. ex) 203.230.7.0/24 주소를 8개의 네트워크로 서브넷팅 하시오.
    6. 호스트가 서브넷의 조건인 경우, 2의 (n+2)승 ≥ 주어진 호스트 숫자로 계산
        1. +2개를 하는 이유는 네트워크 아이디와 브로드캐스트 주소를 포함하기 때문
        2. 호스트 필드에서 오른쪽부터 n개의 비트를 자름
    7. C Class의 경우 표를 사용해 간단히 서브넷팅 할 수 있음
        
        비트, 서브넷마스크, 호스트 개수
        
2. VLSM(Variable Length Subnet Mask) 이란?
    1. 서브넷된 네트워크를 다시 서브넷팅하는 것을 말함
    2. 가장 큰 조건부터 차례로 서브넷팅 해야 함
    3. 위와 같은 조건에서 호스트에 6개의 IP를 필요로 하는 구간이 가장 큰 조건이므로, 8개를 기반으로 서브넷팅 함(네트워크 주소 및 브로드캐스트 포함(
    4. 다음 조건이 2개의 아이피 주소를 필요로 하는 구간이므로 8개 기반의 서브넷팅에서 다시 4개 기반으로 서브넷팅함
    

### IP 주소 부족 문제를 해결하기 위해 서브넷팅과 VLSM 말고 어떤 것이 있을까?

지금 IPv4 환경에서는 주소 부족 문제를 해결하기 위해 DHCP와 NAT 기술이 사용되고 있다. DHCP는 IP 주소를 할당해주고, 이 주소가 필요 없게 된 경우 다시 회수를 하고, NAT는 내부에 있는 장치가 서로 통신할 때는 사설 IP로 통신을 하다가, 외부의 장치와 통신을 할 때는 사설 IP 주소를 공인 IP 주소로 바꿔 통신하는 방식이다. 그러나 이런 방식은 근본적인 해결 방식은 되지 않는다.